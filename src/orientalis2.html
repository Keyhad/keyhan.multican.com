<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Persian Girih Watch - Isfahan Palette</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rakkas&display=swap" rel="stylesheet">

    <style>
        :root {
            /* 
               PALETTE ANALYSIS:
               1. Background: Deepest Midnight (Void)
               2. Lapis Lazuli (Lajvard): Deep Royal Blue for the dial depth.
               3. Turquoise (Firoozeh): The iconic blue-green for minutes.
               4. Saffron/Ochre: Warm accents for seconds.
               5. Sand/Clay: The unglazed lines between tiles.
            */

            --bg-body: #010205; 
            
            /* The "Shah Mosque" Dome Gradient */
            --dial-gradient-inner: #1a237e; /* Lapis Lazuli center */
            --dial-gradient-mid: #0d1333;   /* Deep Indigo */
            --dial-gradient-outer: #000000; /* Shadow edge */
            
            /* Hands/Cursors (Light sources) */
            --hour-active: #ffc107;    /* Amber Gold (Sun) */
            --minute-active: #26c6da;  /* Persian Turquoise (Sky) */
            --second-active: #ff6f00;  /* Saffron (Life) */
            
            /* Grid Lines - mimicking gold wire or unglazed clay */
            --line-color: #c5a059;     
            --line-opacity: 0.4;
            
            /* Inactive slots backlight */
            --light-inactive: rgba(38, 198, 218, 0.03); 
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-body);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .watch-container {
            position: relative;
            width: 90vmin;
            height: 90vmin;
            max-width: 600px;
            max-height: 600px;
            border-radius: 50%;
            box-shadow: 
                0 0 0 2px #1a1a1a,
                0 0 0 8px #050a14, 
                0 20px 50px rgba(0,0,0,1),
                inset 0 0 80px rgba(0,0,0,1);
            background: #000;
            overflow: hidden;
        }

        svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg); 
        }

        #dial-cover {
            fill: url(#mosque-vignette);
            mask: url(#dial-holes-mask); 
        }

        .shape {
            fill: none; 
            stroke: var(--line-color);
            stroke-width: 0.5px;
            stroke-linejoin: round;
            stroke-linecap: round;
            opacity: var(--line-opacity);
        }

        .hour-shape { 
            stroke-width: 0.8px; 
            stroke: url(#ceramic-glaze); /* The tile edge effect */
            fill: url(#hour-lens-grad);   
            filter: url(#rim-shadow);     
            opacity: 1;
        }

        .hour-cardinal { stroke-width: 1.2px; opacity: 1; stroke: #ffe082; }
        .minute-slot-outline { stroke: #3949ab; opacity: 0.5; } /* Dark Indigo lines for minutes */
        .landmark { stroke: #4dd0e1; stroke-width: 0.8px; opacity: 0.8; } 
        .backlight-shape { stroke: none; fill: var(--light-inactive); }

        .cursor-group { transform-origin: 0px 0px; }

        .hour-cursor-shape {
            fill: var(--hour-active);
            filter: drop-shadow(0 0 5px var(--hour-active)) drop-shadow(0 0 15px var(--hour-active));
        }

        .minute-cursor-shape {
            fill: var(--minute-active);
            filter: drop-shadow(0 0 4px var(--minute-active)) drop-shadow(0 0 10px var(--minute-active));
        }

        .second-cursor-shape {
            fill: var(--second-active); 
            stroke: none;
            filter: drop-shadow(0 0 3px var(--second-active));
            mix-blend-mode: screen;
        }

        /* --- CALLIGRAPHY STYLING --- */
        .numeral-text {
            fill: url(#aged-gold-text); 
            font-family: 'Rakkas', serif; 
            font-weight: 400;
            font-size: 20px; 
            text-anchor: middle;
            dominant-baseline: central;
            pointer-events: none;
            
            /* 
               Outline color changed to Deep Indigo (#000033).
               This blends better with the Lapis background than pure black,
               while still providing contrast against the Gold light.
            */
            stroke: #000033; 
            stroke-width: 0.8px;
            paint-order: stroke fill; 
            
            filter: drop-shadow(1px 1px 2px rgba(0,0,0,0.8));
        }
        
        .metal-texture-fill {
            fill: url(#persian-dome-ceramic); 
            pointer-events: none;
        }

        .star-outline {
            fill: none;
            stroke: #c5a059; 
            stroke-width: 0.5px;
            filter: url(#gear-shadow);
        }

        .center-bolt {
            fill: url(#bolt-head);
            stroke: #8a6e3e; 
            stroke-width: 1px;
        }

        .star-gold-tip {
            fill: url(#bright-gold-gradient);
            stroke: none;
            mix-blend-mode: normal; 
        }

    </style>
</head>
<body>

<div class="watch-container">
    <svg viewBox="-100 -100 200 200" id="watchFace">
        <defs>
            <!-- 
                The Mosque Vignette:
                Simulates looking up into a dark tiled dome.
                Starts with Lapis Lazuli, fades to Midnight.
            -->
            <radialGradient id="mosque-vignette" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
                <stop offset="0%" style="stop-color:var(--dial-gradient-inner); stop-opacity:1" />
                <stop offset="60%" style="stop-color:var(--dial-gradient-mid); stop-opacity:1" />
                <stop offset="100%" style="stop-color:var(--dial-gradient-outer); stop-opacity:1" />
            </radialGradient>
            
            <!-- Glassy lens effect over hour markers -->
            <radialGradient id="hour-lens-grad" cx="30%" cy="30%" r="80%" fx="30%" fy="30%">
                <stop offset="0%" style="stop-color:rgba(255,255,255,0.15); stop-opacity:1" />
                <stop offset="100%" style="stop-color:rgba(0,5,15,0.6); stop-opacity:1" />
            </radialGradient>

            <!-- 
                Ceramic Glaze Stroke:
                The outline of the hour shapes. 
                Moves from Turquoise -> Royal Blue -> Gold.
                Typical of 'Haft Rang' tiles.
            -->
            <linearGradient id="ceramic-glaze" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#4dd0e1; stop-opacity:1" /> <!-- Light Turquoise -->
                <stop offset="50%" style="stop-color:#1a237e; stop-opacity:1" /> <!-- Lapis -->
                <stop offset="100%" style="stop-color:#ffd700; stop-opacity:1" /> <!-- Gold touch -->
            </linearGradient>

            <!-- Persian Dome Ceramic (Center Piece) -->
            <radialGradient id="persian-dome-ceramic" cx="30%" cy="30%" r="80%" fx="25%" fy="25%">
                <stop offset="0%" stop-color="#80deea" /> 
                <stop offset="40%" stop-color="#0097a7" /> 
                <stop offset="80%" stop-color="#006064" /> 
                <stop offset="100%" stop-color="#000" /> 
            </radialGradient>

            <!-- Aged Gold Text: Richer, warmer gold -->
            <linearGradient id="aged-gold-text" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" stop-color="#fff9c4" />
                <stop offset="50%" stop-color="#ffca28" />
                <stop offset="100%" stop-color="#ff6f00" />
            </linearGradient>

            <!-- Bright Gold Gradient for Star Tip -->
            <linearGradient id="bright-gold-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#fff8e1" />
                <stop offset="20%" stop-color="#ffe082" />
                <stop offset="50%" stop-color="#ffb300" />
                <stop offset="100%" stop-color="#e65100" />
            </linearGradient>

            <!-- Brass Bolt Head -->
            <radialGradient id="bolt-head" cx="50%" cy="50%" r="50%" fx="30%" fy="30%">
                <stop offset="0%" stop-color="#fff" />
                <stop offset="40%" stop-color="#fbc02d" />
                <stop offset="100%" stop-color="#5d4037" />
            </radialGradient>

            <filter id="rim-shadow" x="-50%" y="-50%" width="200%" height="200%">
                <feDropShadow dx="0.5" dy="1" stdDeviation="1" flood-color="#000" flood-opacity="0.8"/>
            </filter>

            <filter id="gear-shadow" x="-50%" y="-50%" width="200%" height="200%">
                <feDropShadow dx="0" dy="2" stdDeviation="2" flood-color="#000" flood-opacity="0.9"/>
            </filter>

            <mask id="dial-holes-mask">
                <rect x="-150" y="-150" width="300" height="300" fill="white" />
                <g id="mask-holes-group" fill="black"></g>
            </mask>

            <path id="star-geom-def" />
            <path id="star-tip-def" />

            <mask id="rotating-star-mask">
                <rect x="-50" y="-50" width="100" height="100" fill="black" />
                <use id="mask-star-rotator" href="#star-geom-def" fill="white" />
            </mask>
        </defs>

        <!-- LAYER 1: Background Grid -->
        <g id="static-grid-group"></g>

        <!-- LAYER 2: Cursors (Lights) -->
        <g id="hour-cursor-group" class="cursor-group"></g>
        <g id="minute-cursor-group" class="cursor-group"></g>
        <g id="second-cursor-group" class="cursor-group"></g>

        <!-- LAYER 3: Numerals (Text) -->
        <g id="numerals-group"></g>

        <!-- LAYER 4: Dial Cover -->
        <circle id="dial-cover" cx="0" cy="0" r="100"></circle>

        <!-- LAYER 5: Rings -->
        <g id="hour-ring"></g>
        <g id="minute-ring-outlines"></g>
        
        <!-- LAYER 6: The Mechanical Center -->
        <rect x="-30" y="-30" width="60" height="60" 
              class="metal-texture-fill" 
              mask="url(#rotating-star-mask)" />

        <use id="star-tip-rotator" href="#star-tip-def" class="star-gold-tip" />
        <use id="star-stroke-rotator" href="#star-geom-def" class="star-outline" />
        <circle cx="0" cy="0" r="5" class="center-bolt" />

    </svg>
</div>

<script>
    const maskHolesGroup = document.getElementById('mask-holes-group');
    const staticGridGroup = document.getElementById('static-grid-group');
    const numeralsGroup = document.getElementById('numerals-group');
    
    const hourRingGroup = document.getElementById('hour-ring');
    const minuteOutlineGroup = document.getElementById('minute-ring-outlines');
    
    const starGeomDef = document.getElementById('star-geom-def');
    const starTipDef = document.getElementById('star-tip-def');
    
    const maskStarRotator = document.getElementById('mask-star-rotator');
    const starStrokeRotator = document.getElementById('star-stroke-rotator');
    const starTipRotator = document.getElementById('star-tip-rotator');

    const secondCursorGroup = document.getElementById('second-cursor-group');
    const minuteCursorGroup = document.getElementById('minute-cursor-group');
    const hourCursorGroup = document.getElementById('hour-cursor-group');

    const OUTER_RING_CONFIG = { r1: 70, r2: 82, r3: 94, widthAngle: 2.2, roundness: 0.2 };
    const HOUR_RING_CONFIG = { r1: 25, r2: 48, r3: 65, angleSpread: 12, roundness: 0.15 };

    // Eastern Arabic Numerals Map
    const CARDINAL_NUMERALS = {
        0: "١٢", // 12
        3: "٣",  // 3
        6: "٦",  // 6
        9: "٩"   // 9
    };

    function createPath(d, className, id) {
        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
        path.setAttribute("d", d);
        if (className) path.setAttribute("class", className);
        if (id) path.setAttribute("id", id);
        return path;
    }

    function createText(text, x, y, className) {
        const t = document.createElementNS("http://www.w3.org/2000/svg", "text");
        t.setAttribute("x", x);
        t.setAttribute("y", y);
        t.textContent = text;
        if (className) t.setAttribute("class", className);
        // Counter-rotate text by 90deg
        t.setAttribute("transform", `rotate(90, ${x}, ${y}) translate(0, 1)`);
        return t;
    }

    function polarToCartesian(radius, angleInDegrees) {
        const angleInRadians = (angleInDegrees) * Math.PI / 180.0;
        return {
            x: (radius * Math.cos(angleInRadians)),
            y: (radius * Math.sin(angleInRadians))
        };
    }

    function createRoundedDiamondPath(p1, p2, p3, p4, roundness) {
        const lerp = (a, b, t) => ({ x: a.x + (b.x - a.x) * t, y: a.y + (b.y - a.y) * t });
        const p1_a = lerp(p1, p2, roundness);
        const p2_b = lerp(p2, p1, roundness);
        const p2_a = lerp(p2, p3, roundness);
        const p3_b = lerp(p3, p2, roundness);
        const p3_a = lerp(p3, p4, roundness);
        const p4_b = lerp(p4, p3, roundness);
        const p4_a = lerp(p4, p1, roundness);
        const p1_b = lerp(p1, p4, roundness);

        return `M ${p1_a.x} ${p1_a.y} 
                L ${p2_b.x} ${p2_b.y} Q ${p2.x} ${p2.y} ${p2_a.x} ${p2_a.y}
                L ${p3_b.x} ${p3_b.y} Q ${p3.x} ${p3.y} ${p3_a.x} ${p3_a.y}
                L ${p4_b.x} ${p4_b.y} Q ${p4.x} ${p4.y} ${p4_a.x} ${p4_a.y}
                L ${p1_b.x} ${p1_b.y} Q ${p1.x} ${p1.y} ${p1_a.x} ${p1_a.y} Z`;
    }

    function defineCenterStar() {
        const points = 12;
        const outerRadius = 18;
        const innerRadius = 8;
        const roundness = 0.35; 

        const vertices = [];
        for (let i = 0; i < points * 2; i++) {
            let r = (i % 2 === 0) ? outerRadius : innerRadius;
            let angle = i * (360 / (points * 2));
            vertices.push(polarToCartesian(r, angle));
        }

        const lerp = (p1, p2, t) => ({ x: p1.x + (p2.x - p1.x) * t, y: p1.y + (p2.y - p1.y) * t });

        let d = "";
        const len = vertices.length;
        const startPoint = lerp(vertices[len - 1], vertices[0], 0.5);
        d += `M ${startPoint.x} ${startPoint.y} `;
        for (let i = 0; i < len; i++) {
            const current = vertices[i];
            const next = vertices[(i + 1) % len];
            const prev = vertices[(i - 1 + len) % len];
            const pEndCurve = lerp(current, next, roundness);
            const pStartCurve = lerp(prev, current, 1 - roundness);
            d += `L ${pStartCurve.x} ${pStartCurve.y} `;
            d += `Q ${current.x} ${current.y} ${pEndCurve.x} ${pEndCurve.y} `;
        }
        d += "Z "; 
        starGeomDef.setAttribute("d", d);

        const tipIdx = 0;
        const prevIdx = len - 1;
        const nextIdx = 1;
        const vTip = vertices[tipIdx];
        const vPrev = vertices[prevIdx];
        const vNext = vertices[nextIdx];
        const pStartEnter = lerp(vPrev, vTip, 1 - roundness);
        const pEndEnter = lerp(vTip, vNext, roundness);

        let tipD = `M 0 0 `; 
        tipD += `L ${pStartEnter.x} ${pStartEnter.y} `;
        tipD += `Q ${vTip.x} ${vTip.y} ${pEndEnter.x} ${pEndEnter.y} `;
        tipD += `Z`;

        starTipDef.setAttribute("d", tipD);
    }

    function getHourPathData(angle) {
        const r1 = HOUR_RING_CONFIG.r1; 
        const r2 = HOUR_RING_CONFIG.r2; 
        const r3 = HOUR_RING_CONFIG.r3; 
        const p1 = polarToCartesian(r1, angle); 
        const p2 = polarToCartesian(r2, angle + HOUR_RING_CONFIG.angleSpread); 
        const p3 = polarToCartesian(r3, angle); 
        const p4 = polarToCartesian(r2, angle - HOUR_RING_CONFIG.angleSpread); 
        return createRoundedDiamondPath(p1, p2, p3, p4, HOUR_RING_CONFIG.roundness);
    }

    function getMinutePathData(angle) {
        const p1 = polarToCartesian(OUTER_RING_CONFIG.r1, angle);
        const p2 = polarToCartesian(OUTER_RING_CONFIG.r2, angle + OUTER_RING_CONFIG.widthAngle);
        const p3 = polarToCartesian(OUTER_RING_CONFIG.r3, angle);
        const p4 = polarToCartesian(OUTER_RING_CONFIG.r2, angle - OUTER_RING_CONFIG.widthAngle);
        return createRoundedDiamondPath(p1, p2, p3, p4, OUTER_RING_CONFIG.roundness);
    }

    function drawStaticGrid() {
        for (let i = 0; i < 12; i++) {
            const angle = i * 30; 
            let d = getHourPathData(angle);
            maskHolesGroup.appendChild(createPath(d, null));
            let className = "shape hour-shape";
            if (i % 3 === 0) className += " hour-cardinal";
            hourRingGroup.appendChild(createPath(d, className));
            staticGridGroup.appendChild(createPath(d, "backlight-shape"));

            // Add Arabic Numerals at 12, 3, 6, 9
            if (CARDINAL_NUMERALS[i] !== undefined) {
                const center = polarToCartesian(HOUR_RING_CONFIG.r2, angle);
                const textEl = createText(CARDINAL_NUMERALS[i], center.x, center.y, "numeral-text");
                numeralsGroup.appendChild(textEl);
            }
        }

        for (let i = 0; i < 60; i++) {
            const angle = i * 6;
            let d = getMinutePathData(angle);
            maskHolesGroup.appendChild(createPath(d, null));
            let className = "shape minute-slot-outline";
            if (i % 5 === 0) className += " landmark";
            minuteOutlineGroup.appendChild(createPath(d, className));
            staticGridGroup.appendChild(createPath(d, "backlight-shape"));
        }
    }

    function createCursors() {
        const hourD = getHourPathData(0);
        hourCursorGroup.appendChild(createPath(hourD, "hour-cursor-shape"));

        const minD = getMinutePathData(0);
        minuteCursorGroup.appendChild(createPath(minD, "minute-cursor-shape"));

        const angle = 0;
        const expand = 2; 
        const p1 = polarToCartesian(OUTER_RING_CONFIG.r1 - expand, angle);
        const p2 = polarToCartesian(OUTER_RING_CONFIG.r2, angle + OUTER_RING_CONFIG.widthAngle + 1.5);
        const p3 = polarToCartesian(OUTER_RING_CONFIG.r3 + expand, angle);
        const p4 = polarToCartesian(OUTER_RING_CONFIG.r2, angle - OUTER_RING_CONFIG.widthAngle - 1.5);
        let secD = createRoundedDiamondPath(p1, p2, p3, p4, OUTER_RING_CONFIG.roundness);
        secondCursorGroup.appendChild(createPath(secD, "second-cursor-shape"));
    }

    defineCenterStar();
    drawStaticGrid();
    createCursors();

    function updateClock() {
        const now = new Date();
        const hours = now.getHours();
        const minutes = now.getMinutes();
        const seconds = now.getSeconds();
        const ms = now.getMilliseconds();

        const secAngle = (seconds + ms / 1000) * 6;
        const minAngle = (minutes * 6) + (seconds / 60 * 6) + (ms / 60000 * 6);
        const hourAngle = ((hours % 12) * 30) + (minutes / 60 * 30);

        secondCursorGroup.style.transform = `rotate(${secAngle}deg)`;
        minuteCursorGroup.style.transform = `rotate(${minAngle}deg)`;
        hourCursorGroup.style.transform = `rotate(${hourAngle}deg)`;
        
        const rotateTransform = `rotate(${secAngle}deg)`;
        maskStarRotator.style.transform = rotateTransform;
        starStrokeRotator.style.transform = rotateTransform;
        starTipRotator.style.transform = rotateTransform;
        
        requestAnimationFrame(updateClock);
    }
    updateClock();
</script>
</body>
</html>